@using NatureQuestWebsite.Models
@inherits Umbraco.Web.Mvc.UmbracoViewPage<ProductModel>
@{
    var productImages = Model.ProductImages;
    //var productPrices = Model.ProductPrices;
    var featurePrice = Model.FeaturedPrice;

    <div class="row">
        @if (productImages.Any())
        {
            var imageCounter = 0;
            var thumbCounter = 0;
            <div class="col-md-5">
                <div class="product-gallery">
                    @if (featurePrice.SalePercentage > 0)
                    {
                        <span class="product-badge text-danger">
                            @featurePrice.SalePercentage% Off @featurePrice.ProductVariant
                        </span>
                    }
                    <div class="product-carousel owl-carousel gallery-wrapper">
                        @foreach (var productImage in productImages)
                        {
                            //increase the counter
                            imageCounter++;
                            <div class="gallery-item" data-hash="@imageCounter">
                                <a href="@productImage.ImageUrl" title="@productImage.ImageAltText" data-size="350x500">
                                    <img src="@productImage.ImageUrl" alt="@productImage.ImageAltText">
                                </a>
                                <span class="caption">
                                    @productImage.ImageAltText
                                </span>
                            </div>
                        }
                    </div>
                    <ul class="product-thumbnails">
                        @foreach (var productImage in productImages)
                        {
                            thumbCounter++;
                            var thumbClass = thumbCounter == 1 ? "active" : "";
                            <li class="@thumbClass">
                                <a href="#@thumbCounter">
                                    <img src="@productImage.ImageUrl" alt="@productImage.ImageAltText">
                                </a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        }

        <!-- Product Info-->
        <div class="col-md-7">
            @if (Model.ProductStarRating > 0)
            {
                var totalStars = 5;
                <div class="rating-stars">
                    @for (int i = 0; i < Model.ProductStarRating; i++)
                    {
                        totalStars--;
                        <i class="icon-star filled"></i>
                    }

                    @for (int i = 0; i < totalStars; i++)
                    {
                        totalStars--;
                        <i class="icon-star"></i>
                    }
                </div>
            }

            <h2 class="padding-top-1x text-normal">
                @Model.ProductTitle @featurePrice.ProductVariant
            </h2>
            <span class="h2 d-block">
                @if (featurePrice.SalePrice > 0)
                {
                    <del class="text-danger text-normal">$@featurePrice.ProductPrice</del>
                    <text>$</text>@featurePrice.SalePrice
                }
                else
                {
                    <text>$</text>@featurePrice.ProductPrice
                }
            </span>
            @if (!string.IsNullOrWhiteSpace(Model.ProductDescription))
            {
                <p>@Model.ProductDescription</p>
            }

            @using (Html.BeginUmbracoForm("AddProductToCart", "Shop",
                FormMethod.Post,
                new { role = "form", id = "addToCartForm" }))
            {
                @Html.HiddenFor(model => model.ProductPageId)
                @Html.HiddenFor(model => model.ProductCode)

                <div class="row margin-top-1x margin-bottom-1x">
                    <div class="col-md-8">
                        @Html.LabelFor(model => Model.SelectedPricePageId)
                        @Html.DropDownListFor(model => Model.SelectedPricePageId, Model.ProductDisplayPrices, new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => Model.SelectedPricePageId, "", new { @class = "help-block text-danger" })
                    </div>
                    <div class="col-md-4">
                        @Html.LabelFor(m => Model.SelectedQuantity)
                        @Html.TextBoxFor(model => Model.SelectedQuantity, new { @class = "form-control", required = "", placeholder = "Required quantity" })
                        @Html.ValidationMessageFor(model => Model.SelectedQuantity, "", new { @class = "help-block text-danger" })
                    </div>
                </div>

                <div class="d-flex flex-wrap justify-content-between mt-2 mb-2">
                    <div class="sp-buttons mt-2 mb-2">
                        @if (Model.CanBeOrdered)
                        {
                            <button class="btn btn-primary AddToCartBtn">
                                <i class="icon-bag"></i> Add to Cart
                            </button>
                        }
                    </div>
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(Model.PageContentText))
            {
                <div class="row padding-top-1x mb-1">
                    <div class="col-lg-12">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" href="#description" data-toggle="tab" role="tab">
                                    Description
                                </a>
                            </li>
                            @if (Model.ProductIngredients.Any())
                            {
                                <li class="nav-item">
                                    <a class="nav-link" href="#ingredients" data-toggle="tab" role="tab">
                                        Ingredients
                                    </a>
                                </li>
                            }
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="description" role="tabpanel">
                                @Html.Raw(Model.PageContentText)
                            </div>

                            @if (Model.ProductIngredients.Any())
                            {
                                <div class="tab-pane fade show" id="ingredients" role="tabpanel">
                                    <ul>
                                        @foreach (var ingredient in Model.ProductIngredients)
                                        {
                                            <li>@ingredient</li>
                                        }
                                    </ul>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}

@*<div class="entry-share mt-2 mb-2">
        <span class="text-muted">Share:</span>
            <div class="share-links">
                <a class="social-button shape-circle sb-facebook"
                   href="#"
                   data-toggle="tooltip"
                   data-placement="top" title="Facebook">
                    <i class="socicon-facebook"></i>
                </a>
                <a class="social-button shape-circle sb-twitter"
                   href="#"
                   data-toggle="tooltip"
                   data-placement="top" title="Twitter">
                    <i class="socicon-twitter"></i>
                </a>
                <a class="social-button shape-circle sb-instagram"
                   href="#"
                   data-toggle="tooltip"
                   data-placement="top" title="Instagram">
                    <i class="socicon-instagram"></i>
                </a>
            </div>
    </div>*@